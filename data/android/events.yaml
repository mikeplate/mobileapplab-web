title: Events Presentation
heading: Events
type: deck
description: >
  Slides about how to respond to events in Android apps.
  Choose "print" link for a printer-friendly page with all slides after one another.
menu:
- title: Goals
  menu:
  - title: Know how to respond to events in the user interface
  - title: Know how to react to Activity events
  - title: Know how to catch Broadcasts
- title: Events
  menu:
  - title: Everything that happens in an Android app is the result of
    menu:
    - title: An event being fired by the system, possibly from user interaction
    - title: A method being called to respond to that event
    - title: Except if you start your own threads to run in parallell
  - title: You've already responded to at least two events in your apps
    menu:
    - title: The creation of the Activity sent as an event to the onCreate method
    - title: The click of an Button sent as an event to the specified onClick method
- title: Some more examples of events
  menu:
  - title: Activity events
    menu:
    - title: Back button was pressed
    - title: A menu item was chosen by the user
    - title: A second Activity finishes and returns the result
  - title: View events
    menu:
    - title: An item was selected in a Spinner
    - title: A button was clicked for a longer period of time
    - title: The user has touched somewhere in the View
  - title: System events
    menu:
    - title: A SMS text message has been received
    - title: Battery level is low
    - title: The user has chosen to share something from another app with your app
- title: Respond to an event
  menu:
  - title: Event handlers
    menu:
    - title: You've already seen that an event handler is a Java method that is called when the event occurs
    - title: All event handlers should return as quickly as possible since the user interface will be blocked
  - title: Event handler methods specified
    menu:
    - title: In a Java class
      description: >
        Your class "extends" a base class and can then override the event handler methods in the base class
    - title: Or in a Java interface
      description: >
        Your class "implements" an interface and can then implement the event handler methods defined by the interface
- title: Example of overriding method from base class
  menu:
  - title: onBackPressed is fired when back button is pressed on device
    language: java
    code: |
      public class MyActivity extends Activity {
        @Override
        public void onBackPressed() {
          // Do whatever you like!
        }
      }
  - title: Your method will be called instead of base class method
    menu:
    - title: Means that in some cases it is important to call base class method too
    - title: super.onBackPressend();
- title: Example of implementing interface in anonymous class
  menu:
  - title: Create an anonymous object and bind it to the event source in one big statement
    language: java
    code: |
      Button btn = (Button) findViewById(R.id.my_button);
      btn.setOnClickListener(new OnClickListener() {
        public void onClick(View view) {
          // Do what needs to be done!
        }
      });
  - title: If event handler access variables outside of itself, they need to be final
    description: final TextView output = (TextView) findViewById(R.id.some_output_box);
- title: Single event handler for multiple source views
  menu:
  - title: >
      Sometimes desirable to have a single event handler in your code for more than one
      view that fires the same type of event
  - title: Source view is almost always specified as an argument to the event handler
  - title: Identify a particular source view
    menu:
    - title: Use the id of the view
    - title: Use the fact that all views can have extra data associated with it
  - title: Associate extra data with a view in xml
    language: xml
    code: |
      <TextView android:id="@+id/thousand" android:tag="1000"
  - title: Check the extra data in Java
    language: java
    code: |
      public void onTouch(View src, MotionEvent event) {
        int value = Integer.parseInt((String)src.getTag());
        if (src.getId()==R.id.thousand) {
        }
      }
- title: Activity lifetime events
  menu:
  - title: Events fired by the Activity and handled by overriding methods in your own Activity class
  - title: onCreate
    description: >
      Already used. Fired once when the Activity is first created.
  - title: onStart
    description: >
      Fired when the user navigates back to the Activity after running some other Activity
  - title: onResume
    description: >
      Fired when the Activity receives focus again after losing it to something like a Dialog
      and also as a follow up to onStart
  - title: onPause
    description: >
      Fired when the Activity loses focus, either because of something like a Dialog or because of
      the user navigating to another Activity
  - title: onStop
    description: >
      Fired when the user navigates to another Activity
  - title: onDestroy
    description: >
      Fired when the Activity is about to be destroyed (exiting/haven't been used in a while)
- title: Other Activity events
  menu:
  - title: onBackPressed
    description: >
      Fired when the physical back button of the device is pressed. (No event exists for the
      physical home button.)
- title: General View event interfaces
  menu:
  - title: OnClickListener
    menu:
    - title: This event is fired when the user has touched and released a finger on the view
    - title: void onClick(View src)
  - title: OnTouchListener
    menu:
    - title: This event is fired when the user touches, moves and releases any amount of fingers on the view
    - title: boolean onTouch(View src, MotionEvent event)
  - title: OnLongClickListener
    menu:
    - title: This event is fired when the user touches and holds an amount of time on the view
    - title: boolean onLongClick(View src)
- title: Spinner event
  menu:
  - title: OnItemSelectedListener
    description: >
      This event is fired when the user has chosen an option from the drop down list
  - title: Two methods in interface
    menu:
    - title: void onItemSelected(AdapterView<?> src, View selectedView, int selectedPosition, long selectedId)
      description: >
        Depending on how the entries of the Spinner was specified, there might not be any selectedId that is
        valid. Best to use the selectedPosition if the order of options is well known.
    - title: void onNothingSelected(AdapterView<?> src)
      description: >
        Not applicable to a Spinner. The event interface is shared with other visual elements where such
        an event is valid.
- title: SeekBar
  menu:
  - title: Visual element with a knob that you move between endpoints to set a value
    description: >
      Actually extended from the base Progress element that has no interaction and only shows some sort
      of visual progress bar while waiting for an operation to complete
  - title: Attributes
    menu:
    - title: android:max
      description: >
        The maximum value that corresponds to moving the knob to the right-most position
    - title: android:progress
      description: >
        The default value to start at (zero is always the value when the knob is in the left-most position)
- title: SeekBar event interfaces
  menu:
  - title: OnSeekBarChangeListener
    menu:
    - title: void onStartTrackingTouch(SeekBar source)
      description: >
        Called when the user first touches the knob, before moving it
    - title: void onProgressChanged(SeekBar source, int pos, boolean byUser)
      description: >
        Called on every movement of the knob
    - title: void onStopTrackingTouch(SeekBar source)
      description: >
        Called when the user has released the knob and the operation is finished
  - title: >
      Even if you only need to catch onProgressChanged, all methods must be defined (but can be empty)
- title: Menus on Android
  menu:
  - title: Most (all older) Android devices have a physical menu button
    description: >
      Requirement was removed when tablets and Android 3.0 appeared, where the menu button can appear as
      a virtual button on the screen instead.
  - title: Therefore, two versions depending on Android version
    menu:
    - title: Menu pops up from the bottom of screen (older version, before 3.0)
    - title: Menu pops down from the so called ActionBar at the top of screen (from 3.0)
  - title: You can write the same code and the platform will display using the version at hand
    description: >
      All methods and callbacks (event handlers) are the same for the two versions
- title: Menu handling
  menu:
  - title: Event sent to Activity to create options in the menu
    description: >
      So can't be set statically at any point. I guess because menu options are more often than not
      dependent on the current context, selected item etc.
  - title: Example
    language: java
    code: |
      @Override
      boolean onCreateOptionsMenu(Menu menu) {
        menu.add(NONE, 123, 1, "Do something");
        return true;
      }
  - title: Event sent to Activity when user has chosen an option
    language: java
    code: |
      @Override
      boolean onOptionsItemSelected(MenuItem item) {
        if (item.getItemId()==123) {
          doSomething();
          return true;
        }
        return false;
      }
- title: More information
  menu:
  - title: Book references
